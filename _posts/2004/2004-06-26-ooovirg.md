---
post_id: 2233
title: 'OOoVirg &#8211; Une virgule sous OpenOffice.org en fran√ßais'
date: '2004-06-26T18:24:28+02:00'
last_modified_at: '2018-12-01T20:23:26+01:00'
author: 'R√©mi Peyronnet'
layout: post
guid: '/?p=2233'
slug: ooovirg
permalink: /2004/06/ooovirg/
URL_before_HTML_Import: 'http://www.lprp.fr/win/ooovirg/ooovirg.php3'
image: /files/2018/11/virgule_1541283462.png
categories:
    - Informatique
tags:
    - OldWeb
    - Virgule
lang: fr
lang-ref: pll_5bde2377094b0
lang-translations:
    en: ooovirg_en
    fr: ooovirg
---

English users : this page has now been translated [here](/2004/06/ooovirg_en/) (well I did not figure in the first place that this piece of software would interest non french speaking people üôÇ

[T√©l√©charger !](/files/old-web/win/ooovirg/ooovirg_tray.zip) *(DLLs suppl√©mentaires si besoin : [ici](/files/old-web/win/ooovirg/dllsrelease.zip), et la version pr√©c√©dente en cas de probl√®mes : [ici](/files/old-web/win/ooovirg/ooovirg_tray_030621.zip))*  
Utilisateurs de Windows 95 : [version sp√©cifique windows 95](/files/old-web/win/ooovirg/ooovirg_tray_win95.zip) (si besoin, [les DLL MFC42 pour Windows 95](/files/old-web/win/ooovirg/mfc42_win95.zip).  
Pour Linux, ou pour une ancienne version du logiciel, voir [cette page](/2003/06/sovirgule/).

Les solutions possibles sont les suivantes, √† vous de voir laquelle correspond le mieux √† votre utilisation :  
[Param√©trer le point comme s√©parateur d√©cimal dans OpenOffice.org](#param)  
[OOoVirg, un petit utilitaire qui remplacera le point d√©cimal par une virgule uniquement dans OpenOffice.org](#ooovirg)  
[Mapper d√©finitivement le point par une virgule dans la base de registre.](#registry)  
[Utiliser le Microsoft Keyboard Creator pour cr√©er un clavier avec la virgule.](#mskc)

## Derni√®res Nouvelles

### 04/12/2004

Il m‚Äôa √©t√© signal√© qu‚Äôil √©tait souhaitable que OOoVirg remplace √©galement le point par une virgule dans les fen√™tres de dialogue, sans pour autant devoir passer en mode ‚ÄúToutes Fenetres‚Äù. Une solution a √©t√© trouv√©e, mais comme elle n‚Äôest pas encore compl√®tement test√©e, elle n‚Äôest pas pour l‚Äôinstant int√©gr√©e dans la distribution de base. Pour en b√©n√©ficier, t√©l√©chargez le fichier [oovirghk.dll](/files/old-web/win/ooovirg/oovirghk.dll) et remplacez la version pr√©c√©dente que vous aviez. Il vous faudra relancer OOoVirg, et en principe le s√©parateur d√©cimal devrait correctement √™tre remplac√© partout. Merci de me pr√©venir en cas de probl√®me, pour correction avant inclusion dans la version principale.

### 25/04/2004

- Suite √† des probl√®mes d‚Äôincompatibilit√© avec Windows 95 et de mauvais fonctionnement sous la famille NT, la fonctionnalit√© de filtre selon le nom de l‚Äôex√©cutable a √©t√© retir√©e.
- Internationalisation : l‚Äôinterface est maintenant plus facile √† traduire (seul le fichier de ressources est √† modifier) et poss√®de maintenant une traduction anglaise qui devrait √™tre propos√©e sur les windows non fran√ßais (fonctionnalit√© non test√©e)
- Syst√®me d‚Äôiconisation am√©lior√©.

### 07/03/2004

Nouvelle version de [OOoVirg](/files/old-web/win/ooovirg/ooovirg_tray.zip), qui corrige trois probl√®mes fr√©quents :

- Conflits avec des logiciels utilisant √©galement une capture clavier (iTouch de Logitech, Autocad,‚Ä¶)
- Ic√¥ne de TrayBar qui se confond avec celle du d√©marrage rapide (Merci √† Fr√©d√©ric Vuillod)
- Un probl√®me de DLL non trouv√©e sous Windows 95, d√ª au nom long

### 21/06/2003

La licence de OOoVirg passe maintenant √† L-GPL. La raison de ce changement de licence est de pouvoir int√©grer le code source de ce outil directement dans OpenOffice.org, pour une int√©gration parfaite. Pour participer √† cette int√©gration, ou pour avoir plus d‚Äôinformations, rendez-vous sur les mailing liste d‚ÄôOpenOffice.org (dev-fr@openoffice.org ou Issue 1820).

Le package propos√© √† l‚Äô√©quipe OpenOffice.org est : [ooovirg\_integration.zip](/files/old-web/win/ooovirg/ooovirg_integration.zip). Il contient, quelques remarque sur l‚Äôint√©gration + OOoVirg + 1 solution de hook local windows plus propre + la solution xmodmap en C.

**Ce programme devrait donc devenir sous peu obsol√®te.**

## OpenOffice.org en Fran√ßais

Pour passer StarOffice en Fran√ßais, rien de plus simple. Sous Windows, ceci se fait lors de l‚Äôinstallation windows. Le probl√®me est qu‚Äôune fois en fran√ßais, le s√©parateur d√©cimal dans StarOffice est la virgule, mais celui de votre clavier num√©rique est le point. Ce n‚Äôest pas pratique. L‚Äôobjectif est donc de remplacer le point du clavier num√©rique par une virgule, comme dans Excel en Fran√ßais.

<a name="param"></a>

## Premi√®re solution : demander le point comme s√©parateur d√©cimal.

La manipulation est d√©crite dans la FAQ de OpenOffice.org ([http://fr.openoffice.org/FAQ/calc\_fr/c25fr.html](http://fr.openoffice.org/FAQ/calc_fr/c25fr.html)). Il suffit dans les options de choisir dans `Format / Cellules / Nombres` l‚Äôoption `Anglais`.

<a name="ooovirg"></a>

## Deuxi√®me solution : un petit utilitaire.

Si vous souhaitez garder la virgule comme s√©parateur d√©cimal, j‚Äôai √©crit un petit utilitaire qui vous permettra de taper une virgule √† la place du point du pav√© num√©rique, et ceci exclusivement dans OpenOffice.org (ou StarOffice) : ceci n‚Äôaffectera pas le comportement dans d‚Äôautres applications.

[T√©l√©charger la derni√®re version !](/files/old-web/win/ooovirg/ooovirg_tray.zip)  
Selon votre installation, vous pouvez avoir besoin de ces DLLs : [DLLs redistribuables Microsoft VC](/files/old-web/win/ooovirg/dllsrelease.zip).

[T√©l√©charger une version de debug](/files/old-web/win/ooovirg/ooovirg_tray_dbg.zip) (si vous avez des probl√®mes)  
Vous pouvez avoir besoin de ces dlls : [DLLs redistribuables Microsoft de debug](/files/old-web/win/ooovirg/dllsdebug.zip).

### Installation

Ce programme s‚Äôinstalle dans la TrayBar, √† cot√© de l‚Äôhorloge : vous y trouverez le logo OpenOffice.org avec une virgule.

Ce programme doit √©galement √™tre lanc√© √† chaque d√©marrage de Windows. Je vous conseille donc de cr√©er un raccourci de ce programme dans le menu Programmes/D√©marrage de votre menu D√©marrer. Pour cela, il suffit de faire un glisser-d√©poser de l‚Äô√©xecutable dans le menu D√©marrer / Programmes / D√©marrage.

### Configuration

La configuration par d√©faut est satisfaisante pour la version 1.0 d‚ÄôOpenOffice.org. Vous pouvez l‚Äôadapter pour les versions futures d‚ÄôOpenOffice.org, pour StarOffice (version 5 et 6), ou pour n‚Äôimporte quel autre logiciel. Il suffit pour cela de double cliquer sur l‚Äôicone, de choisir la m√©thode voulue, et de relancer le programme ou l‚Äôordinateur.

Les m√©thodes pour identifier si le programme doit oui ou non remplacer le point par une virgule sont :

- Toutes les fen√™tres : remplacement syst√©matique.
- Titre : si cette option est coch√©e, le titre de la fen√™tre doit contenir le texte indiqu√©.
- ClassName : si cette option est coch√©e, la classe de la fen√™tre doit contenir le texte indiqu√©.
- Ex√©cutable : si cette option est coch√©e, le nom de l‚Äô√©xecutable doit contenir le texte indiqu√©. (Ne marche pas encore)

Il est possible de combiner plusieurs de ces options : il faut alors que la fen√™tre satisfasse √† tous les crit√®res coch√©s.

### Capture d‚Äô√©cran

![](/files/old-web/win/ooovirg/ooovirg_scr.jpg)

### Licence

Le programme est bien √©videmment gratuit, et le code source est disponible pour que vous puissiez le faire √©voluer et l‚Äôadapter √† vos besoins, dans le respect de la licence L-GPL.

Le principe est tout √† fait g√©n√©rique, et peu √™tre √©tendu √† d‚Äôautres applications. Certains r√©glages sont possibles.

Pour plus d‚Äôinformations : [remi+ooovirg@via.ecp.fr](mailto:remi+ooovirg@via.ecp.fr?subject=OpenOfficeHook).

### Support / FAQ

Ce programme a fonctionn√© sous Windows 2000 / XP, et sous Windows 95 / 98SE / ME.  
Cependant, de mani√®re inexplicable, il arrive que cela ne fonctionne pas sous certains Win98SE. Si cela est votre cas, d√©cochez l‚Äôoption filtrant sur les fen√™tres OpenOffice, pour √©ventuellement opter pour un autre filtrage (pax ex. par nom de binaire) cela semble marcher mieux.

#### Windows rale ‚ÄúFichier non trouv√© : OOVirgHook.dll‚Äù

Copier ce fichier (inclus dans le zip) dans le r√©pertoire `C:WindowsSystem32`.

#### Le programme semble ne pas fonctionner.

Aller dans l‚Äô√©cran de configuration, s√©lectionner ‚ÄúActif sur toutes les fenetres‚Äù et red√©marrer le logiciel.

<a name="registry"></a>

## Autre solution : la base de registre

Il est √©galement possible √† partir de Windows 2000/XP de d√©cider de remplacer compl√®tement une touche par une autre, donc par exemple de compl√®tement remplacer le point du pav√© num√©rique par une virgule. Evidemment, ce r√©glage sera appliqu√© pour tous les programmes sans distinction, ce qui n‚Äôest pas l‚Äôid√©al. Le seul int√©r√™t r√©side dans la simplicit√© de mise en oeuvre : un simple fichier registre suffit, et tout le traitement est g√©r√© en natif par Windows.

*Comme ce n‚Äôest pas la m√©thode que j‚Äôutilise, je n‚Äôai pas fait le .reg en question‚Ä¶ Cependant vous pouvez consulter la page des [trucs et astuces](/2001/11/trucs/) qui explique comment se servir du mappage de caract√®re pour enlever le CAPS Lack. Le principe est tout √† fait identique, et l‚Äôadaptation pour la virgule ne devrait pas poser de probl√®mes. Si vous avez besoin d‚Äôaide, n‚Äôh√©sitez pas.*

Add On : Michel Bigle l‚Äôa fait pour vous : [mapcomma.reg](/files/old-web/win/ooovirg/mapcomma.reg)

<a name="mskc"></a>

## Une autre solution √©l√©gante pour Windows 2000 / XP / 2003 ou sup√©rieur.

Microsoft met √† disposition gratuitement un utilitaire [Microsoft Keyboard Layout Creator](http://www.microsoft.com/globaldev/tools/msklc.mspx). Celui-ci permet de configurer un clavier en remappant certaines touches. Vous trouverez un peu d‚Äôaide sur [cet article du forum hardware.fr](http://forum.hardware.fr/hardwarefr/WindowsSoftwareReseaux/sujet-180317-1.htm).

Pour le cas qui nous int√©resse, voici un exemple r√©alis√© par Michel Bigle : [mskc\_decimal.zip](/files/old-web/win/ooovirg/mskc_decimal.zip) fait correspondre une virgule au point d√©cimal du clavier num√©rique. Ce qui est tr√®s agr√©able avec cette m√©thode est la facilit√© de basculement d‚Äôun clavier √† l‚Äôautre, car ce clavier est compl√®tement int√©gr√© √† la gestion des claviers de Windows, et appara√Æt dans la barre de langue :

![Windows Keyboard Management](/files/old-web/win/ooovirg/clavier_windows.jpg)

Il suffit alors d‚Äôun clic pour passer d‚Äôun clavier √† l‚Äôautre. Merci √† Michel Bigle pour cette solution √©l√©gante.

<a name="old"></a>

## Ancienne version du logiciel

J‚Äôai √©crit un programme permettant de changer le s√©parateur d√©cimal du pav√© num√©rique en une virgule, lorsque le titre de la fen√™tre commence par StarOffice. Je suis en train de faire une interface un peu plus correcte.

En attendant, vous pouvez vous contenter de la version actuelle :

- [DLL](/files/old-web/win/ooovirg/kdbhook.dll)
- [Chargeur de la DLL](/files/old-web/win/ooovirg/loadkbdhook.exe)

Lorsque vous lancez StarOffice, lancez loadkbdhood.exe. Le tour est jou√© !